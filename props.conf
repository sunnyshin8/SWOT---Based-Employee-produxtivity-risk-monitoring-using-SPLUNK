[csv]
# CIM Data Model Compliance for Employee Productivity
# Maps to Change, Authentication, and Performance data models

# Employee Information Mappings
EVAL-user = employee_id
EVAL-src_user = employee_id
EVAL-user_type = "employee"
EVAL-user_category = case(performance_score >= 4, "high_performer", performance_score >= 3, "average_performer", performance_score < 3, "low_performer")

# Performance Metrics
EVAL-productivity_score = round((performance_score * 2 + (work_hours_per_week/40) + (projects_handled/10) + (training_hours/50) - (sick_days/5) + (employee_satisfaction_score/5)) / 6, 2)
EVAL-engagement_score = round((employee_satisfaction_score + (training_hours/10) + (promotions*2) - (sick_days*0.5)) / 4, 2)
EVAL-risk_score = round((sick_days + overtime_hours/10 + if(resigned=="True", 5, 0) + (5-performance_score) - (employee_satisfaction_score)) / 5, 2)

# Time-based calculations
EVAL-tenure_months = years_at_company * 12
EVAL-work_life_balance = case(overtime_hours <= 5, "excellent", overtime_hours <= 15, "good", overtime_hours <= 25, "fair", overtime_hours > 25, "poor")

# SWOT Category Assignment
EVAL-swot_category = case(
    productivity_score >= 3.5 AND engagement_score >= 3.5 AND risk_score <= 2, "Strength",
    productivity_score < 2.5 OR engagement_score < 2.5 OR risk_score >= 4, "Threat",
    (productivity_score >= 2.5 AND productivity_score < 3.5) AND (engagement_score >= 2.5 AND engagement_score < 3.5), "Weakness",
    (productivity_score > 3 OR engagement_score > 3) AND risk_score < 3, "Opportunity"
)

# Department and Role Classifications
EVAL-dept_category = case(
    match(department, "IT|Engineering"), "Technical",
    match(department, "Sales|Marketing"), "Revenue",
    match(department, "HR|Legal|Operations"), "Support",
    match(department, "Finance|Customer Support"), "Operations"
)

# Remote Work Classification
EVAL-work_arrangement = case(
    remote_work_frequency == 100, "Fully Remote",
    remote_work_frequency >= 75, "Mostly Remote", 
    remote_work_frequency >= 50, "Hybrid",
    remote_work_frequency >= 25, "Mostly Office",
    remote_work_frequency == 0, "Fully Office"
)

# Attrition Risk Indicators
EVAL-attrition_risk = case(
    resigned=="True", "Resigned",
    risk_score >= 4 AND productivity_score < 2.5, "High Risk",
    risk_score >= 3 AND engagement_score < 3, "Medium Risk",
    risk_score < 2 AND productivity_score > 3.5, "Low Risk",
    1==1, "Monitor"
)

# Performance Trend Simulation (based on tenure and current metrics)
EVAL-performance_trend = case(
    years_at_company <= 1 AND performance_score >= 4, "Rising Star",
    years_at_company > 5 AND performance_score >= 4, "Veteran Performer", 
    years_at_company > 3 AND performance_score <= 2, "Declining",
    performance_score >= 3, "Stable",
    1==1, "Needs Attention"
)

# Alert Triggers
EVAL-alert_level = case(
    swot_category=="Threat" AND attrition_risk=="High Risk", "Critical",
    swot_category=="Threat", "High",
    swot_category=="Weakness" AND risk_score >= 3, "Medium",
    swot_category=="Opportunity", "Info",
    1==1, "None"
)

# Burnout Indicators
EVAL-burnout_risk = case(
    overtime_hours > 20 AND sick_days > 10 AND employee_satisfaction_score < 2, "High",
    overtime_hours > 15 AND employee_satisfaction_score < 3, "Medium", 
    sick_days > 8 OR employee_satisfaction_score < 2.5, "Low",
    1==1, "Minimal"
)

# Data Quality and Completeness
EVAL-data_completeness = case(
    isnotnull(employee_id) AND isnotnull(performance_score) AND isnotnull(employee_satisfaction_score), "Complete",
    1==1, "Incomplete"
)
